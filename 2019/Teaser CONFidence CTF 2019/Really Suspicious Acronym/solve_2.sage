kn = 34825223743402829383680359547814183240817664070909938698674658390374124787235739502688056639022131897715513587903467527066065545399622834534513631867145432553730850980331789931667370903396032758515681278057031496814054828419443822343986117760958186984521716807347123949922837482460532728350223473430713058522361175980521908817215812291272284241848086260180382693014713901303747444753828636575351349026883294939561001468099252543181336195746032718177937417431101756313823635150129601855358558635996348271242920308406268552606733676301725088348399264293936151662467456410825402303921583389167882090767423931762347825907802328053

r = (0xDEAD * 2^1023) / (0xBEEF * 2^1023 + 2^500)
pbar = int(sqrt(kn * r))

P.<x> = PolynomialRing(Zmod(kn), implementation='NTL')
f = x + pbar

roots = f.small_roots(X=2**500, beta=0.5)
p = int(roots[0]) + pbar
q = kn // p
print(p,q)
e=65537
d = inverse_mod(e, (p-1)*(q-1))
print(d)